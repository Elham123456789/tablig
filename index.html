<!-- ===============================
     قسم المراسلات – جاهز 100%
================================ -->

<style>
/* لوحة المراسلات */
#commsPanel{
  position:fixed;
  top:10%;
  left:50%;
  transform:translateX(-50%);
  width:min(650px,95vw);
  background:#fff;
  border:1px solid #e6efec;
  border-radius:14px;
  box-shadow:0 18px 48px rgba(0,0,0,.25);
  display:none;
  z-index:9999;
}
.comms-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px;
  border-bottom:1px solid #e6efec;
  background:#f0f7f5;
  font-weight:700;
}
.comms-body{
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:10px;
}
.comms-row{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.comms-row input,
.comms-body textarea{
  width:100%;
  padding:10px;
  border-radius:8px;
  border:1px solid #cfe1dd;
  font-family:inherit;
}
.comms-body textarea{
  min-height:180px;
}
.comms-actions{
  display:flex;
  gap:8px;
  justify-content:center;
  flex-wrap:wrap;
}
.btn{
  background:#0f7a66;
  color:#fff;
  border:none;
  border-radius:10px;
  padding:10px 14px;
  cursor:pointer;
}
.btn:hover{background:#0c594e}
.close-btn{
  background:#ef4444;
  color:#fff;
  border:none;
  border-radius:8px;
  padding:6px 10px;
  cursor:pointer;
}
</style>

<!-- زر فتح المراسلات -->
<button class="btn" id="btnComms">✉️ مراسلات</button>

<!-- نافذة المراسلات -->
<div id="commsPanel">
  <div class="comms-head">
    <span>مراسلات</span>
    <button class="close-btn" id="commsClose">✕</button>
  </div>

  <div class="comms-body">
    <div class="comms-row">
      <input id="mailTo" placeholder="البريد الإلكتروني">
      <input id="waPhone" placeholder="رقم واتساب (9665xxxxxxx)">
    </div>

    <textarea id="commsTxt" placeholder="سيتم توليد نص الرسالة هنا…"></textarea>

    <div class="comms-actions">
      <button class="btn" id="btnMake">توليد</button>
      <button class="btn" id="btnCopy">نسخ</button>
      <button class="btn" id="btnWA">واتساب</button>
      <button class="btn" id="btnMail">بريد</button>
    </div>
  </div>
</div>

<script>
const $ = s => document.querySelector(s);

$('#btnComms').onclick = ()=> $('#commsPanel').style.display='block';
$('#commsClose').onclick = ()=> $('#commsPanel').style.display='none';

function makeMsg(){
return `السلام عليكم ورحمة الله وبركاته،

نأمل منكم الاطلاع على ......

شاكرين ومقدرين اهتمامكم.

مديرة المدرسة`;
}

$('#btnMake').onclick = ()=> $('#commsTxt').value = makeMsg();

$('#btnCopy').onclick = ()=>{
  $('#commsTxt').select();
  document.execCommand('copy');
  alert('تم نسخ الرسالة');
};

$('#btnWA').onclick = ()=>{
  const phone = ($('#waPhone').value||'').replace(/\D+/g,'');
  if(!phone) return alert('أدخل رقم واتساب');
  window.open(`https://wa.me/${phone}?text=${encodeURIComponent($('#commsTxt').value)}`);
};

$('#btnMail').onclick = ()=>{
  if(!$('#mailTo').value) return alert('أدخل البريد الإلكتروني');
  location.href = `mailto:${$('#mailTo').value}?subject=مراسلة&body=${encodeURIComponent($('#commsTxt').value)}`;
};
</script>
